# 実装タスクリスト

## Phase 1 (MVP) - 詳細タスク

### 🚀 T1. プロジェクト基盤整備
#### T1.1 ディレクトリ構造作成
- [x] `src/types/` - 型定義ディレクトリ
- [x] `src/components/ui/` - UIコンポーネント
- [x] `src/components/tabs/` - タブコンポーネント  
- [x] `src/hooks/` - カスタムフック
- [x] `src/app/api/` - APIルート
- [x] `src/utils/` - ユーティリティ関数

**完了条件**: 必要なディレクトリがすべて作成済み

#### T1.2 型定義ファイル作成
- [x] `src/types/index.ts` - 基本型定義
  - Company, CompanyList
  - Prompt, PromptList  
  - LLMModel, LLMConfig
  - AnalysisResult, AppState
  - TabType

**完了条件**: TypeScript エラーなしでビルド可能

**依存**: T1.1

---

### 🎨 T2. 基本UIコンポーネント作成
#### T2.1 汎用UIコンポーネント
- [x] `src/components/ui/Button.tsx`
  - Primary, Secondary バリアント
  - Loading 状態対応
  - Disabled 状態対応
- [x] `src/components/ui/Input.tsx`
  - テキスト入力
  - バリデーションエラー表示
- [x] `src/components/ui/Textarea.tsx`
  - 複数行テキスト入力
  - 自動リサイズ機能
- [x] `src/components/ui/Select.tsx`
  - ドロップダウン選択
  - プレースホルダー対応
- [x] `src/components/ui/Card.tsx`
  - コンテンツ領域の枠組み

**完了条件**: 各コンポーネントがStorybook的に動作確認済み

**テスト方法**: 一時的なテストページで各コンポーネントを表示

**依存**: T1.2

#### T2.2 ローディング・エラーUI
- [x] `src/components/ui/Loading.tsx`
  - スピナーアニメーション
  - テキスト付きローディング
- [x] `src/components/ui/Toast.tsx` (簡易版)
  - 成功・エラーメッセージ表示

**完了条件**: ローディング状態とエラー状態の表示が可能

**依存**: T2.1

---

### 🏗️ T3. レイアウトコンポーネント
#### T3.1 ヘッダーコンポーネント
- [x] `src/components/Header.tsx`
  - アプリタイトル表示
  - LLM選択ドロップダウン（仮データ）
  - レスポンシブ対応

**完了条件**: ヘッダーが正しく表示され、LLM選択が動作

**テスト方法**: 選択値の変更でconsole.logに出力

**依存**: T2.1

#### T3.2 タブナビゲーション
- [x] `src/components/TabNavigation.tsx`
  - 3つのタブ（要約入力、プロンプト、結果表示）
  - アクティブタブのハイライト
  - タブクリックによる切り替え
- [x] `src/hooks/useTabState.ts`
  - 現在のタブ状態管理
  - タブ切り替え関数

**完了条件**: タブクリックで表示内容が切り替わる

**テスト方法**: 各タブをクリックしてコンテンツエリアが変化することを確認

**依存**: T3.1

---

### 📝 T4. 企業要約入力機能
#### T4.1 企業入力コンポーネント
- [x] `src/components/CompanyInput.tsx`
  - 企業名入力フィールド
  - 要約テキストエリア
  - 削除ボタン（比較企業のみ）
  - バリデーション表示

**完了条件**: 企業情報の入力・編集・削除が可能 ✅

**テスト方法**: 入力値の変更でstate更新を確認

**依存**: T2.1

#### T4.2 企業管理フック
- [x] `src/hooks/useCompanies.ts`
  - 基準企業・比較企業の状態管理
  - 企業追加・削除機能
  - バリデーション機能

**完了条件**: 企業の追加・削除・編集がstate経由で動作 ✅

**テスト方法**: 企業追加後に配列が更新されることを確認

**依存**: T1.2

#### T4.3 要約入力タブ
- [x] `src/components/tabs/SummaryInputTab.tsx`
  - 基準企業入力エリア
  - 比較企業入力エリア（動的）
  - 企業追加ボタン（最大4社制限）
  - 次へボタン

**完了条件**: 企業情報の入力が完了し、プロンプトタブに遷移可能 ✅

**テスト方法**: 5社目の追加が無効になることを確認

**依存**: T4.1, T4.2, T3.2

---

### ✏️ T5. プロンプト入力機能
#### T5.1 基本プロンプト入力
- [x] `src/components/tabs/PromptTab.tsx`
  - プロンプト名入力フィールド
  - プロンプト内容テキストエリア
  - 動的参照のヘルプテキスト
  - 実行ボタン

**完了条件**: プロンプトの入力・編集が可能 ✅

**テスト方法**: プロンプト入力時にstate更新を確認

**依存**: T2.1, T3.2

#### T5.2 プロンプト状態管理
- [x] `src/hooks/usePrompts.ts`
  - 現在のプロンプト状態管理
  - 基本的な保存機能（Phase 2で拡張）

**完了条件**: プロンプトの状態管理が動作 ✅

**依存**: T1.2

---

### 🔄 T6. LLM連携機能
#### T6.1 LLM API設定
- [x] `.env.local.example` - 環境変数設定例
- [x] `src/utils/llm-clients.ts` - Azure OpenAI & Gemini クライアント
- [x] 基本的なエラーハンドリング

**完了条件**: Azure OpenAI & Gemini APIへの接続テストが成功 ✅

**テスト方法**: 簡単なプロンプトでAPI呼び出し

**依存**: T1.1

#### T6.2 API ルート作成
- [x] `src/app/api/analyze/route.ts`
  - POST リクエスト受付
  - プロンプト置換処理（動的変数対応）
  - Azure OpenAI & Gemini API 呼び出し
  - レスポンス統一・整形

**完了条件**: フロントエンドからのリクエストを正常処理 ✅

**テスト方法**: Postman等でAPI単体テスト

**依存**: T6.1

#### T6.3 LLM実行フック
- [x] `src/hooks/useLLM.ts`
  - 分析実行関数
  - ローディング状態管理
  - エラーハンドリング
  - 結果保存・再実行機能

**完了条件**: プロンプト実行から結果取得まで動作 ✅

**テスト方法**: ボタンクリックでAPI呼び出しし、レスポンス取得を確認

**依存**: T6.2

---

### 📊 T7. 結果表示機能
#### T7.1 結果表示コンポーネント
- [x] `src/components/tabs/ResultTab.tsx`
  - 実行情報表示（LLM名、プロンプト名）
  - 分析結果テキスト表示
  - 詳細な使用量情報（トークン・料金）

**完了条件**: 分析結果が読みやすく表示される ✅

**テスト方法**: 実際の分析実行後に結果が正しく表示されることを確認

**依存**: T2.1, T3.2

#### T7.2 結果操作機能
- [x] `src/components/ResultActions.tsx`
  - 結果コピーボタン（全体・部分別）
  - 再実行ボタン
- [x] `src/hooks/useClipboard.ts`
  - クリップボードコピー機能

**完了条件**: 結果のコピーと再実行が動作 ✅

**テスト方法**: コピーボタンでクリップボードに内容が保存されることを確認

**依存**: T7.1

---

### 🔗 T8. 統合・動作確認
#### T8.1 フロー統合テスト
- [ ] 要約入力 → プロンプト入力 → 実行 → 結果表示の一連の流れ
- [ ] エラーケースの動作確認
- [ ] レスポンシブ表示の基本確認

**完了条件**: エンドツーエンドでの動作が完了

**テスト方法**: 実際のIR要約データを使用した完全なテストシナリオ実行

**依存**: T3-T7のすべて

#### T8.2 最終調整
- [ ] UI/UXの微調整
- [ ] エラーメッセージの改善
- [ ] ローディング表示の調整
- [ ] スタイリングの統一

**完了条件**: MVP として利用可能な品質

**依存**: T8.1

---

---

### 🌐 T0. AWS Amplifyデプロイ設定 (追加要件)
#### T0.1 Amplify設定ファイル作成
- [x] `amplify.yml` - Amplifyビルド設定
- [x] `next.config.ts` - Amplify対応Next.js設定
- [x] 環境変数設定ドキュメント作成

**完了条件**: Amplifyでのデプロイが可能な設定完了 ✅

#### T0.2 環境変数・セキュリティ設定
- [x] OpenAI API キー環境変数設定（Phase 2で使用予定）
- [x] セキュリティヘッダー設定確認
- [x] 本番環境向けエラーハンドリング

**完了条件**: セキュアな本番環境設定完了 ✅

**依存**: なし

---

## 🗓️ 実装スケジュール

### Week 0: AWS Amplifyデプロイ準備 ✅
- Day 1: T0 (Amplifyデプロイ設定) ✅

### Week 1: 基盤整備
- Day 1-2: T1 (プロジェクト基盤整備) ✅
- Day 3-5: T2 (基本UIコンポーネント) ✅

### Week 2: レイアウト・入力機能
- Day 1-2: T3 (レイアウトコンポーネント)
- Day 3-5: T4 (企業要約入力機能)

### Week 3: プロンプト・API連携
- Day 1-2: T5 (プロンプト入力機能)
- Day 3-5: T6 (LLM連携機能)

### Week 4: 結果表示・統合
- Day 1-2: T7 (結果表示機能)
- Day 3-5: T8 (統合・動作確認)

## 📋 作業進行ルール

### 1. タスク実行順序
- 依存関係を必ず確認してから着手
- 1つのタスクを完了してから次に進む
- 完了条件を満たすまで次のタスクには進まない

### 2. テスト・確認方法
- 各タスクに記載された「テスト方法」を必ず実行
- コンソールエラーがないことを確認
- TypeScriptの型エラーがないことを確認

### 3. コード品質
- ESLintエラーの解消
- 適切なコメント記述
- 再利用可能なコンポーネント設計

### 4. 進捗管理
- 各サブタスクの完了時にチェックマークを更新
- 問題発生時は詳細を記録
- 仕様変更が必要な場合はSPEC.mdを更新

## 🎯 成功基準

**Phase 1 完了の定義:**
1. 3つのタブすべてが動作する
2. 企業要約の入力・編集が可能
3. プロンプトの入力・実行が可能
4. OpenAI GPT-4での分析が実行される
5. 結果が適切に表示される
6. エラーハンドリングが基本的に動作する
7. モバイルでも基本的に使用可能

**次フェーズへの移行条件:**
- すべてのT1-T8タスクが完了
- エンドツーエンドテストが成功
- 実際のIRデータでの動作確認済み
